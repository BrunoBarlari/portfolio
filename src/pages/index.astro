---
import Base from "../layouts/Base.astro";
import MenuBar from "../components/MenuBar.astro";
import Window from "../components/Window.astro";
import { projects } from "../data/projects";
import { profile } from "../data/profile";

const githubLabel = profile.links.github
	? "@" + profile.links.github.split("/").filter(Boolean).pop()
	: "";
const twitterLabel = profile.links.twitter
	? "@" + (profile.links.twitter as string).split("/").filter(Boolean).pop()
	: "";
let linkedinLabel = "";
try {
	linkedinLabel = profile.links.linkedin
		? new URL(profile.links.linkedin).pathname
		: "";
} catch {
	linkedinLabel = profile.links.linkedin || "";
}
---

<Base>
	<MenuBar currentPath={Astro.url.pathname} />
	<main class="pt-12 px-4 mx-auto" id="content">
		<div class="container">
			<div class="desktop-grid">
				<Window title="About" initiallyOpen={true} size="md">
					<div id="about">
						<h1 class="hero-name">{profile.name}</h1>
						<p class="text-sm mt-2 font-semibold">{profile.headline}</p>
						<p class="mt-3 text-sm leading-relaxed">{profile.intro}</p>
					</div>
				</Window>

				<Window title="Skills" initiallyOpen={true} size="md">
					<div id="skills" class="grid-skills">
						<div>
							<strong>Lenguajes</strong><br />TypeScript · JavaScript · Python ·
							Go
						</div>
						<div>
							<strong>Frontend</strong><br />Astro · React · Vue · Tailwind
						</div>
						<div>
							<strong>Backend</strong><br />Node.js · REST · GraphQL · SQL/NoSQL
						</div>
						<div>
							<strong>DevOps</strong><br />CI/CD · Docker · Observabilidad
						</div>
						<div>
							<strong>Calidad</strong><br />Testing · Linting · Code Review
						</div>
						<div>
							<strong>Metodologías</strong><br />Lean · Kanban · Domain-Driven
						</div>
					</div>
				</Window>

				<Window title="Contact" initiallyOpen={true} size="sm">
					<div id="contact">
						<p>¿Conversamos? Puedes escribirme o conectar en redes:</p>
						<ul class="text-sm list-disc pl-5 leading-relaxed">
							<li>
								Email: <a href={profile.links.email} class="btn-link"
									>{profile.contactEmail}</a
								>
							</li>
							{
								profile.links.linkedin && (
									<li>
										LinkedIn:{" "}
										<a
											href={profile.links.linkedin}
											class="btn-link"
											rel="noopener noreferrer"
											target="_blank"
										>
											{linkedinLabel}
										</a>
									</li>
								)
							}
							{
								profile.links.github && (
									<li>
										GitHub:{" "}
										<a
											href={profile.links.github}
											class="btn-link"
											rel="noopener noreferrer"
											target="_blank"
										>
											{githubLabel}
										</a>
									</li>
								)
							}
							{
								profile.links.twitter && (
									<li>
										Twitter:{" "}
										<a
											href={profile.links.twitter}
											class="btn-link"
											rel="noopener noreferrer"
											target="_blank"
										>
											{twitterLabel}
										</a>
									</li>
								)
							}
						</ul>
					</div>
				</Window>

				<Window title="Projects" initiallyOpen={true} size="lg">
					<div id="projects" class="projects-list">
						{
							projects.map((p) => (
								<article class="project">
									<h3 class="project-title">
										{p.title} {p.year && <small class="year">· {p.year}</small>}
									</h3>
									<p class="project-summary">{p.summary}</p>
									{p.tech && <p class="project-tech">{p.tech.join(" · ")}</p>}
									{p.links && p.links.length > 0 && (
										<p class="project-links">
											{p.links
												.map((l) => (
													<a
														href={l.url}
														class="btn-link"
														rel="noopener noreferrer"
														target={
															l.url.startsWith("http") ? "_blank" : undefined
														}
													>
														{l.label}
													</a>
												))
												.reduce(
													(acc, el, i, arr) =>
														acc.concat(el, i < arr.length - 1 ? " · " : ""),
													[]
												)}
										</p>
									)}
								</article>
							))
						}
					</div>
				</Window>
			</div>
		</div>
	</main>
</Base>
