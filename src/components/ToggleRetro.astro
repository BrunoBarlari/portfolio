---
/** ToggleRetro: only SFX toggle (persistence + respects prefers-reduced-motion) */
---

<div class="retro-toggles" style="display:flex; gap:.5rem; align-items:center; font-size:12px;">
	<label><input type="checkbox" data-sfx /> SFX</label>
</div>
<script is:inline>
	(function () {
		const root = document.currentScript.parentElement;
		const sfx = root.querySelector("[data-sfx]");

		function fallbackDefault() {
			const saved = localStorage.getItem("retroSounds");
			if (saved === "1") return true;
			if (saved === "0") return false;
			return !matchMedia("(prefers-reduced-motion: reduce)").matches;
		}
		sfx.checked = fallbackDefault();
		import('/src/lib/sfx.js')
			.then((mod) => mod && mod.getSfx ? mod.getSfx() : null)
			.then((api) => {
				if (!api) return;
				// sync UI
				sfx.checked = !!api.enabled;
				sfx.addEventListener('change', () => api.setEnabled(sfx.checked));
			})
			.catch(() => {});
	})();
</script>
<style is:inline>
	.retro-toggles input { vertical-align: middle; }
</style>
